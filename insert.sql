create table pesele(
	pesel char(11)
);

insert into pesele select unnest(array['89031742321','73072147746','95101464299','05251928934','87052095976','05232415749','67013169111','99051726573','63050255127','06281333183','60072081493','82100757499','51020148612','84111453559','95051464284','01260189429','59032864199','99060435316','73121427511','51042137687','97012093788','82052441468','51012091474','81080693597','63102049557','95051395454','96121714928','77091363767','51053094562','82070189126','90041264253','67081857374','49080392328','72042988233','65020338269','78041431864','72081172875','85072819765','73091349479','54020465556','62070765526','84020385248','94060882564','06231168249','52091397385','02301541413','96061926799','92050159346','83060798294','96040928622','06260717928','60041441114','85012253886','50071543568','65020995853','93030273348','69110465224','80090688722','59030148992','87110195387','67121741917','54031571576','89080985371','62121244521','49071117354','53100357668','03292471653','57020589974','02292644555','63093031414','58081527891','88090248698','72121734362','55040935452','01260979996','92072788988','85041781431','91021221352','55111262816','63081255914','69082082283','47010212128','60011879567','51041162293','79062026118','69052188757','90101973666','79113023358','77061311262','61022326431','69102859558','57020525347','90120412153','06260115559','48031389541','97111386325','76121614626','88110818382','64102186284','96012279655','54080692569','59083016842','84111683651','96040519653','47080984691','88031638931','90022578968','84102259153','98050715597','90013171138','63051066676','06301736448','75012045752','53083067884','06271492612','69122392147','92031588837','55052965474','48111944356','61010222752','49020542451','76102378693','90062717974','06290649482','86011657848','48061094282','55080432823','01250357513','48102689879','60041039364','72080347692','70121124394','02230741869','53110413486','91020443768','02211516561','80020564254','82031924537','71062684486','72012246183','88030977972','87041838885','92082045978','53062234519','93021536812','06232252574','96121626155','77041464425','87020961418','86121743194','77043015773','84123122342','97100444946','04281946385','55052033692','55031157971','52052238232','70033139312','99062376839','05321834721','87072238496','60091468495','67050753388','61052537265','95091125484','51082067331','94092339883','64010413946','70121934881','95062465438','02311718669','69042827947','64111951592','86090173134','61121775437','65012722524','68080577827','68113063583','55122479292','63060283996','82022271781','97012646573','90100517566','01312829549','04222167549','83060795833','57041391143','03212876634','64060957942','79120293616','50093041127','48102551219','03241232135','02210832916','75091637776','71082272911','81071012857','65062183472','94012551184','77080547479','00282361866','59031791694','78040773464','60021819799','64041416811','81040583562','91010639993','95041424465','96111655428','84022818717','47010724845','51041787364','47073038556','88110314512','92012988894','80082924445','98020966631','47091039896','04220364665','00250967672','54052958736','69061366465','72072956518','79083115372','00270498853','93060158398','58051771563','63122675839','77022127781','85051554661','52061168281','97110312178','86090735372','48122521564','66090844762','04230568244','52011081417','87100884428','73042634674','91112862389','53112851789','63100767859','68121343277','51051454737','90011132825','48101454391','64030982561','50101239351','92101863622','53032684199','83092455725','62012566853','99080639576','75112424978','82041177523','48062082552','91022556646','73051191812','90040412121','81051173493','51090639346','69083027111','03220583698','63051352229','02253141835','00292897591','04281988365','61020178276','95050699528','67050351869','76111173436','06230689754','60072333484','63052267373','94031342822','85062597178','65081332336','71101071714','94030173836','67082528435','63111421577','92120749673','91121949235','59033197757','48082061717','97092217582','50072754152','48042752567','92071544347','88052565139','67060812796','71070937778','56012238182','70112975189','80071141244','66081847633','95123141176','06211168346','98051329472','49092346487','72100826947','85031712775','60080432759','02251878115','98062035524','99032699478','90060367614','86012128141','66020378138','66122478181','47120843896','47012659413','80062422279','84060584412','87020525245','76031478141','49012447135','84051538372','79120292332','76051015397','52012737881','00271612214','85050181417','93020968348','01222035786','72090332381','79110873376','69091376164','85020871694','97092467499','51052995147','00290444788','66122793626','67041833622','99040114859','50040233579','05312469695','73082064583','84090137668','68011296472','66022584184','84101125819','05310742725','02322294251','56051968123','87030999782','88060938226','74012033194','93040434939','87072868275','89070459226','95061846524','03241453273','90111983448','94100886183','70010535263','67021922692','99042882183','93091239286','64111396429','76060218938','80072331534','06222614731','95122044623','06271022729','66120955493','69061944865','56100548142','05322328146','60021984211','91100226922','88082119836','55041997833','70073162622','81070333221','68011679682','84012586332','73112089559','76050853981','56063018742','01280873643','54090878663','95112492654','87090933722','73061765377','66120572245','91040924685','72122123785','82062114998','86103091972','69042534861','82101415677','83061676694','62101594495','63070934268','88122178496','02240314361','88030261158','50061052489','51072162844','73051381554','70101339967','02280371124','73111216284','97120249314','79032376944','88081867631','82092237461','02212641974','63042153941','93042372534','73011926313','80101143167','53090957536','73050732429','56021521529','80072353761','48062513144','81091552795','69051848533','70052199382','58062848575','01272657569','69011865396','60122473436','89040298213','03300637862','97122089723','73012765272','47110793947','85082442685','57111383975','64081486618','84022266657','70052887829','78030752688','02250839931','86082091428','94122094591','87011014817','52081661144','00303116637','56052851828','81111418568','50110199538','99051492715','53021085822','87011389692','78080156814','00320789263','84123157933','72010174765','72082162857','54040952878','77011136943','86071714167','87042469589','48021197295','66121848488','82010158847','76012579887','54042566141','77111575792','89070212131','65012743422','02261514441','64090621673','60121864778','91032134344','86052685381','52050911162','60092224869','56040271137','86041112726','81100151494','76021261313','98090333825','94051851593','76081858926','61010233824','75070118928','61041655143','49112159255','50060599521','04271232937','70102524641','88021092732','77081413614','77041593871','65032271464','55012825143','99020724869','93110791577','06310479154','78113077541','88113075937','78052741226','93102885411','74013198117','71040287177','76032513274','47061691871','02272146239','75100687523','82122943939','78101465958','83050312325','53022419778','00320328754','89052285254','76122111221','98010662499','79121263333','53061581575','89112173466','59012845796','87101233979','88092889622','75052636473','59052772898','97010186138','59093066725','79041819724','95072622537','49020676345','56041427827','50122632575','84032552362','61112358755','94050461674','52030319319','61080988714','74112794935','89100411253','50110243466','92072128599','88120594955','98092315171','80070787788','73061197659','56091538823','90011529476','89090289834','51040284343','62091293512','98051279432','72072269713','00240969284','49072289483','99051287881','57060139425','73081331279','97120811289','76040466742','99060334646','94111353568','99072672769','52071825866','47052384571','88052778733','77120137222','86050349735','48072384136','86111967579','74112316539','66011221557','71082491552','95071145129','76082845936','71102395189','00322745852','48092272693','87030469658','03321245132','61121318229','61101798816','03212439194','69040764521','61101372977','58033113622','66050392247','50071876479','61012295716','74121616938','78022078763','58012114332','59032888434','83040129238','72102637525','91060937447','70012423924','59062317614','83091954836','75020365172','81042238538','70041624978','64091146838','71120731844','82093058234','69111861975','96050323398','60021114214','60101924986','99081613351','65020388134','05231429877','63072823173','80062025823','62090744439','62080537991','87122869342','95100265464','83051889457','83073026764','63011885574','76122499248','92081286716','93052651577','95031743798','50041769912','99092197842','67062983571','02260729574','55101754284','47082193572','62080731838','06213194479','05221211253','47112931796','85032488756','57051795597','79021713521','88090713361','05290868668','84010488278','52041379546','76071347728','49110528392','93022359786','87030789327','57072735637','92032037217','79011327963','57102322134','91041482364','00320256273','66120797837','74042421169','06252864481','51071775355','06311843781','85021585798','90012332927','98092114978','79091813129','54081677147','63041273198','75030713938','68120227385','59092115376','47072023948','83011347829','48031851822','68080524898','02290988929','95110182393','93031137144','68051782818','93012087392','73122123942','49040228773','92060262791','95091251929','59012767254','94081698331','04312715379','91040389624','00290949948','75012199888','55072196913','90041918473','04310732572','72033146514','94050551517','80032112524','94110283677','69012297752','75022245993','04261619362','74071526233','93070988929','77061984763','61020628245','83081911434','64011744748','56092884299','05321314119','80030459656','75051758844','53110849823','80062124331','54122268655','56112653412','85030991599','98092192888','81042573314','78120274423','83091859537','00312019376','65010521569','53112573137','66062256753','91111373266','80092495764','47102576336','77110495648','00232055359','06262572529','91100495841','91011298878','02311716766','52010652122','76081695563','00280738956','86112992732','69090299891','70082973297','60071054283','77071617161','69042187519','56100369671','83122184117','71071733786','93123182625','55032479894','54101695863','53113042216','70060183324','65032931492','48100936553','86060494764','51052784811','48020795166','85050335571','73020585857','92121621459','76032397674','72031718917','56040914278','51030418417','03252317353','61091489734','59050251867','90031794973','98051683482','63101526387','90050914433','92102175382','56112613137','64081911174','68020865452','95122421325','76020758788','98090631985','52092597647','90021624967','58122119591','77090659229','82041682618','64121689223','90112273612','47050737456','63052595425','77030779615','73053164319','73080264473','65101623293','69050646941','80120619919','66053085885','68010569478','06250833223','64032837258','60082814591','53011656238','99123123378','95090831988','96082565175','62012986918','63110615849','61092384687','70010812159','63111341927','64062518422','02272092585','01321357666','75041159279','90050716318','65041084628','48071468941','49040552425','04320237498','60040365842','74031637544','64051678748','94011282436','64122065237','96062223352','98081856179','83072164342','04280753634','87091117792','88031899361','63013038147','79030972142','96060477982','59081938364','68110214593','75092593871','67033057951','88011992765','88042931416','94010724931','92030634911','04271881926','73090984813','77121125462','66091042558','64071777739','88041981719','73080144173','96073147812','76031957958','69022455593','99121994842','60010719365','73122221541','58090446396','49040234956','05230743312','92092034531','05300148186','54032976226','85072742883','61071142336','75091591245','53120699832','62112948737','48052461187','88102221826','58031475816','88050287671','79011628873','54031071526','69061718873','98100541183','75100714892','70111149158','84090312814','96122555452','89111537535','52053167225','78062875982','66060968421','50101775125','56071251591','02240533513','69062146815','04211926245','87111557285','54051281587','71081556737','62082988955','01321797239','97102541245','47021288569','63072182218','59092755721','73011838885','62120126163','67020697186','72011974173','92080927849','71011133252','06242023931','83120913472','78040672961','53071599911','98082787652','55012467279','89020555439','96022647837','82022085159','72020914771','55102078611','79012017555','79112359287','96051824744','89121293423','52092191278','67081819343','82120952216','63101123355','79010523322','56081148384','61050728931','48050246634','50073066669','68032933464','02281939183','60121678184','93122582457','04281597642','54040574915','87070369358','00281796692','95072985928','00301591452','81110541261','85112185845','04290644537','59060713757','73082366524','55022022244','75091972699','81092044774','90042027327','65013118661','02250176573','73053171791','75100164963','92071343342','88010514124','57051047441','06302794146','62021482294','96033138885','82012397918','64062374941','05240478279','97123046642','85102791937','47091187995','58060733824','88051727974','87042416239','88062454474','02311628962','99070427354','98060327199','52100115137','68111148314','59030257113','04260253323','77071283665','51050154737','88111986448','67062012774','84012074899','76102728696','65010975979','63031484485','56080775796','82051375175','05320762715','67082055696','55091144445','69081344223','78083041663','73022621812','53101029287','62012969113','06270282258','06300484175','82062194374','82081743649','89051747946','99042077967','68080157595','60061457856','52072763943','71040413855','05281591681','71011466422','74122935537','88061524718','61061114451','85051755895','86072026315','54050286514','78072351735','70120671361','54080167393','96063086341','03321488667','01241524346','53020163761','91100284225','60060531654','89051611357']);

insert into pacjenci 
select          
	null,             
    left(md5(random()::text),10),
    left(md5(random()::text),10),
	'1234',
	round(random()::numeric * 1000000000 % 900000000  + 100000000,0),
    left(md5(random()::text),30),
	left(md5(random()::text),30),
	a.pesel
from generate_series(1, 1) left join pesele a on 1=1;

delete from pesele;
insert into pesele select unnest(array['89110192821','58052739926','70012651123','83021689658','58061039684','60122341216','89011997187','71060247962','04242058177','86112557522','50121226319','70082539934','92071262753','80052251128','57101295354','55042666923','66111395781','50032411336','76062222537','91041713334','84041247532','79031223155','67061521376','95100249936','90030286862']);

insert into lekarze 
select          
	null,             
    left(md5(random()::text),10),
    left(md5(random()::text),10),
	'1234',
	round(random()::numeric * 1000000000 % 900000000  + 100000000,0),
    left(md5(random()::text),30),
	left(md5(random()::text),30),
	a.pesel,
	b.nazwa
from (select *,row_number() OVER () as number from(select * from pesele order by random() limit 25)z)a
 left join (select *,row_number() OVER () as number from(select w.nazwa from (select * from specjalizacje)w,specjalizacje order by random() limit 25)x)b 
on a.number = b.number;

drop table pesele;

insert into urlop select id_osoba as id_lekarza,'2022-05-01' as data_od,'2022-05-03' as data_do from lekarze order by random() limit 1;
insert into urlop select id_osoba as id_lekarza,'2022-05-03' as data_od,'2022-05-05' as data_do from lekarze order by random() limit 1;
insert into urlop select id_osoba as id_lekarza,'2022-05-05' as data_od,'2022-05-07' as data_do from lekarze order by random() limit 1;
insert into urlop select id_osoba as id_lekarza,'2022-05-07' as data_od,'2022-05-09' as data_do from lekarze order by random() limit 1;
insert into urlop select id_osoba as id_lekarza,'2022-05-09' as data_od,'2022-05-10' as data_do from lekarze order by random() limit 1;

insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-01 08:00:00' as data_od,'2022-05-01 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-02 08:00:00' as data_od,'2022-05-02 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-03 08:00:00' as data_od,'2022-05-03 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-04 08:00:00' as data_od,'2022-05-04 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-05 08:00:00' as data_od,'2022-05-05 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-06 08:00:00' as data_od,'2022-05-06 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-07 08:00:00' as data_od,'2022-05-07 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-08 08:00:00' as data_od,'2022-05-08 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-09 08:00:00' as data_od,'2022-05-09 16:00:00' as data_do from lekarze order by random() limit 20;
insert into lekarze_dyzur select id_osoba as id_lekarza,'2022-05-10 08:00:00' as data_od,'2022-05-10 16:00:00' as data_do from lekarze order by random() limit 20;

select wizyta((select id_osoba from pacjenci where pesel = '97120215878'),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 08:30:00','2022-05-01 09:00:00');

create or replace function insert_wizyty()
  returns void as $$
begin
  for i in 1..30 loop
	PERFORM wizyta((select id_osoba from pacjenci order by random() limit 1),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 08:00:00','2022-05-01 08:30:00');
	PERFORM wizyta((select id_osoba from pacjenci order by random() limit 1),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 08:30:00','2022-05-01 09:00:00');
	PERFORM wizyta((select id_osoba from pacjenci order by random() limit 1),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 09:00:00','2022-05-01 09:30:00');
	PERFORM wizyta((select id_osoba from pacjenci order by random() limit 1),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 09:30:00','2022-05-01 10:00:00');
	PERFORM wizyta((select id_osoba from pacjenci order by random() limit 1),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 10:00:00','2022-05-01 10:30:00');
	PERFORM wizyta((select id_osoba from pacjenci order by random() limit 1),(select nazwa from specjalizacje order by random() limit 1),'2022-05-01 10:30:00','2022-05-01 11:00:00');
  end loop;
end;
$$ language 'plpgsql';

select insert_wizyty();
drop function insert_wizyty;